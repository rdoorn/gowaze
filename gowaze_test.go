package gowaze

import (
	"encoding/json"
	"log"
	"testing"

	"github.com/stretchr/testify/assert"
)

var data = []byte(`{"alternatives":[{ "response": { "results": [ { "path": { "segmentId": 162906242, "nodeId": 96420422, "x": 4.83501222, "y": 52.64617304, "direction": false }, "street": 31, "altStreets": null, "distance": 2498, "length": 39, "crossTime": 7, "crossTimeWithoutRealTime": 7, "tiles": null, "clientIds": null, "knownDirection": true, "penalty": 6, "roadType": 1, "isToll": false, "naiveRoute": null, "detourSavings": 0, "detourSavingsNoRT": 0, "useHovLane": false, "attributes": 0, "lane": "WHOLE_SEGMENT", "laneType": null, "areas": [], "requiredPermits": [], "detourRoute": null, "naiveRouteFullResult": null, "detourRouteFullResult": null, "mergeOffset": 0, "avoidStatus": "OPEN", "clientLaneSet": null, "additionalInstruction": null, "instruction": { "opcode": "TURN_LEFT", "arg": 0, "instructionText": null, "laneGuidance": null, "name": null, "tts": null } }, { "path": { "segmentId": 162906240, "nodeId": 163169012, "x": 4.834910660982185, "y": 52.64589437710413, "direction": true }, "street": 31, "altStreets": null, "distance": 2505, "length": 11, "crossTime": 2, "crossTimeWithoutRealTime": 2, "tiles": null, "clientIds": null, "knownDirection": true, "penalty": 0, "roadType": 1, "isToll": false, "naiveRoute": null, "detourSavings": 0, "detourSavingsNoRT": 0, "useHovLane": false, "attributes": 0, "lane": "WHOLE_SEGMENT", "laneType": null, "areas": [], "requiredPermits": [], "detourRoute": null, "naiveRouteFullResult": null, "detourRouteFullResult": null, "mergeOffset": 0, "avoidStatus": "OPEN", "clientLaneSet": null, "additionalInstruction": null, "instruction": { "opcode": "APPROACHING_DESTINATION", "arg": 0, "instructionText": null, "laneGuidance": null, "name": null, "tts": null } } ], "streetNames": [ "Boeing Avenue", null, "Fokkerweg", "Pudongweg", null, "N201 ri A4", "N201 - Rozenburgdreef", "A4 ri Amsterdam / Utrecht / Haarlem (A5)", "A4 - Parallel", "A5 ri Zaanstad / Haarlem", "A5", null, "A9 ri Alkmaar / Haarlem", "A9", "A9 ri Haarlem / Alkmaar", "Brug in de A-9", "A9 ri Den Helder / Alkmaar", "A9 ri Den Helder / Alkmaar / Uitgeest-Noord", "N242 ri Leeuwarden / Heerhugowaard", "N242 - Ommering", "N242 - Provincialeweg", "Leeghwaterbrug", "N242 - Westerweg", "N242 - Provincialeweg", "N508 / Ring Alkmaar", null, "N508 - Nollenweg", "Oosttangent", "Huygenhoekring", "West Frieslandsingel", "West-Frieslandsingel", "Bongerd" ], "tileIds": [], "tileUpdateTimes": [], "geom": null, "fromFraction": 0.9930584021592773, "toFraction": 0.4524405026450892, "sameFromSegment": true, "sameToSegment": true, "astarPoints": null, "wayPointIndexes": null, "wayPointFractions": null, "tollMeters": 0, "preferedRouteId": -1, "isInvalid": false, "isBlocked": false, "serverUniqueId": "m5962760943860057719", "displayRoute": true, "astarVisited": 52179, "astarResult": "UNKNOWN", "astarData": null, "isRestricted": false, "avoidStatus": "OPEN", "dueToOverride": null, "passesThroughDangerArea": false, "distanceFromSource": 1, "distanceFromTarget": 9, "minPassengers": 0, "hovIndex": -1, "timeZone": null, "routeType": [ "Best", "Natural" ], "routeAttr": [], "astarCost": 2876, "reorderChoice": null, "totalRouteTime": 2507, "laneTypes": [], "preferredStoppingPoints": null, "areas": [], "requiredPermits": [], "etaHistograms": [], "entryPoint": null, "shortRouteName": "A9", "tollPrice": 0, "segGeoms": null, "routeName": "A9", "routeNameStreetIds": [ 40922439, 7316711 ], "open": true }, "coords": [ { "x": 4.7515984499999995, "y": 52.27740505, "z": "NaN" }, { "x": 4.75135042558197, "y": 52.27751822784823, "z": "NaN" }, { "x": 4.750890079905853, "y": 52.27766629643053, "z": "NaN" }, { "x": 4.750469001020219, "y": 52.27775671610251, "z": "NaN" }, { "x": 4.75001037120838, "y": 52.2778914442893, "z": "NaN" }, { "x": 4.749832601415591, "y": 52.277969621985015, "z": "NaN" }, { "x": 4.749832601415591, "y": 52.277969621985015, "z": "NaN" }, { "x": 4.749711235284811, "y": 52.27809867366343, "z": "NaN" }, { "x": 4.74817105, "y": 52.27873899000001, "z": "NaN" }, { "x": 4.74817105, "y": 52.27873899, "z": "NaN" }, { "x": 4.74782836, "y": 52.27888616, "z": "NaN" }, { "x": 4.74782836, "y": 52.27888616, "z": "NaN" }, { "x": 4.74770413, "y": 52.27878957, "z": "NaN" }, { "x": 4.747704129999999, "y": 52.27878957000003, "z": "NaN" }, { "x": 4.746605709073791, "y": 52.27786541601257, "z": "NaN" }, { "x": 4.745469496222044, "y": 52.277067702842594, "z": "NaN" }, { "x": 4.745469496222044, "y": 52.277067702842594, "z": "NaN" }, { "x": 4.7454162433106575, "y": 52.27703035866343, "z": "NaN" }, { "x": 4.7454162433106575, "y": 52.27703035866343, "z": "NaN" }, { "x": 4.74532197472622, "y": 52.27696513443539, "z": "NaN" }, { "x": 4.74532197472622, "y": 52.27696513443537, "z": "NaN" }, { "x": 4.7442382574079, "y": 52.27609952800599, "z": "NaN" }, { "x": 4.7442382574079, "y": 52.276099528006, "z": "NaN" }, { "x": 4.681476692829156, "y": 52.47260266194918, "z": "NaN" }, { "x": 4.68322779, "y": 52.47431642999999, "z": "NaN" }, { "x": 4.68428478, "y": 52.47541975000003, "z": "NaN" }, { "x": 4.685189173894512, "y": 52.47648460740451, "z": "NaN" }, { "x": 4.685189173894512, "y": 52.476484607404494, "z": "NaN" }, { "x": 4.68629564, "y": 52.47778738999999, "z": "NaN" }, { "x": 4.68684999, "y": 52.478515130000005, "z": "NaN" }, { "x": 4.68801283, "y": 52.480157549999994, "z": "NaN" }, { "x": 4.68960242, "y": 52.48248694000001, "z": "NaN" }, { "x": 4.69047169, "y": 52.48365192, "z": "NaN" }, { "x": 4.69156636, "y": 52.48498569, "z": "NaN" }, { "x": 4.692723510621412, "y": 52.486285215156975, "z": "NaN" }, { "x": 4.692723510621412, "y": 52.486285215156975, "z": "NaN" }, { "x": 4.6944362, "y": 52.48827556999999, "z": "NaN" }, { "x": 4.69530839, "y": 52.489356530000016, "z": "NaN" }, { "x": 4.696147693942567, "y": 52.49050105596793, "z": "NaN" }, { "x": 4.696147693942567, "y": 52.49050105596793, "z": "NaN" }, { "x": 4.696163247844304, "y": 52.49052271438033, "z": "NaN" }, { "x": 4.69665278, "y": 52.49120437, "z": "NaN" }, { "x": 4.6972705, "y": 52.49216487999999, "z": "NaN" }, { "x": 4.69781889, "y": 52.49308933, "z": "NaN" }, { "x": 4.69843609, "y": 52.494197750000005, "z": "NaN" }, { "x": 4.6988637, "y": 52.49502466000002, "z": "NaN" }, { "x": 4.69941859, "y": 52.49619634999998, "z": "NaN" } ], "segCoords": null } ] }`)

func TestRoute(t *testing.T) {
	/*v := New()
	assert.Nil(t, v.Login())

	route, err := v.GetRoute(4.7515934, 52.2774235, 4.834963, 52.645738)
	assert.Nil(t, err)

	log.Printf("route: %+v", route)*/
}

func TestRouteJson(t *testing.T) {
	var route Route

	err := json.Unmarshal(data, &route)
	assert.Nil(t, err)

	log.Printf("route: %+v", route)
	log.Printf("routetimes: %+v", route.TravelTimes())
}
